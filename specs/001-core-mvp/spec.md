# Feature Specification: GEO Analyzer Core MVP

**Feature Branch**: `001-core-mvp`
**Created**: 2025-12-01
**Status**: Draft
**Input**: GEO Analyzer Phase 1 - 쿼리 분석, 4개 LLM 인용 추출, 결과 표시

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 쿼리 분석 및 인용 결과 확인 (Priority: P1)

마케터로서, 특정 검색 쿼리를 입력하면 4개 AI 검색 엔진(Perplexity, ChatGPT, Gemini, Claude)에서
내 도메인이 어떻게 인용되는지 확인하고 싶다. 이를 통해 AI 검색 최적화 전략을 수립할 수 있다.

**Why this priority**: 이것이 제품의 핵심 가치이며, 다른 모든 기능의 기반이 된다.

**Independent Test**: 쿼리 입력 후 4개 LLM의 분석 결과를 확인할 수 있으며, 각 LLM에서
인용된 도메인 목록과 내 도메인 포함 여부를 즉시 파악할 수 있다.

**Acceptance Scenarios**:

1. **Given** 사용자가 메인 페이지에 있고, **When** 쿼리와 타겟 도메인을 입력하고 분석 버튼을 클릭하면, **Then** 4개 LLM 모두에 대한 분석이 시작되고 로딩 상태가 표시된다.
2. **Given** 분석이 진행 중일 때, **When** 각 LLM의 응답이 완료되면, **Then** 해당 LLM의 결과 카드에 답변 내용, 인용된 소스 목록, 내 도메인 포함 여부가 표시된다.
3. **Given** 4개 LLM 중 일부가 실패했을 때, **When** 나머지 LLM 응답이 완료되면, **Then** 성공한 LLM의 결과는 정상 표시되고 실패한 LLM은 에러 메시지가 표시된다.
4. **Given** 분석이 완료되었을 때, **When** 결과 요약 섹션을 확인하면, **Then** 전체 인용률, 브랜드 멘션율, LLM별 비교 정보가 표시된다.

---

### User Story 2 - 분석 결과 상세 확인 (Priority: P2)

마케터로서, 특정 분석의 상세 결과를 확인하여 각 LLM이 인용한 소스의 세부 정보
(URL, 제목, 발췌문, 신뢰도 점수 등)를 파악하고 싶다.

**Why this priority**: 분석 결과의 깊이 있는 이해를 위해 필요하지만, 기본 분석 기능 없이는
의미가 없으므로 P1 다음 순위.

**Independent Test**: 분석 상세 페이지에서 각 LLM별 전체 인용 목록과 메타데이터를 확인할 수 있다.

**Acceptance Scenarios**:

1. **Given** 분석이 완료되었을 때, **When** 상세보기 버튼을 클릭하면, **Then** 분석 상세 페이지로 이동하여 전체 결과를 확인할 수 있다.
2. **Given** 상세 페이지에서, **When** 특정 LLM 결과를 확인하면, **Then** 해당 LLM의 모델명, 응답 시간, 전체 답변, 인용 목록(URL, 도메인, 제목, 발췌문)이 표시된다.
3. **Given** Gemini 결과를 확인할 때, **When** 인용 목록을 보면, **Then** 각 인용에 대한 신뢰도 점수(confidenceScores)가 표시된다.
4. **Given** 타겟 도메인이 인용된 경우, **When** 해당 인용을 확인하면, **Then** 시각적으로 강조 표시되어 쉽게 식별할 수 있다.

---

### User Story 3 - 분석 이력 관리 (Priority: P3)

마케터로서, 이전에 수행한 분석 이력을 조회하여 시간에 따른 인용 현황 변화를
추적하고 싶다.

**Why this priority**: 장기적인 트렌드 파악에 유용하지만, 개별 분석 기능이 먼저 완성되어야 한다.

**Independent Test**: 분석 이력 페이지에서 과거 분석 목록을 확인하고 특정 분석을 선택하여
상세 결과를 볼 수 있다.

**Acceptance Scenarios**:

1. **Given** 사용자가 분석 이력 페이지에 접근하면, **When** 페이지가 로드되면, **Then** 최근 분석 목록이 날짜순으로 표시된다.
2. **Given** 분석 목록에서, **When** 특정 분석을 클릭하면, **Then** 해당 분석의 상세 페이지로 이동한다.
3. **Given** 분석 목록이 많을 때, **When** 스크롤하면, **Then** 추가 분석 이력이 로드된다.
4. **Given** 분석 이력이 없을 때, **When** 페이지에 접근하면, **Then** 분석이 없다는 안내 메시지가 표시된다.

---

### Edge Cases

- 모든 4개 LLM이 동시에 실패하면 어떻게 되는가?
  → 전체 분석 실패로 처리하고 사용자 친화적인 에러 메시지 표시
- LLM 응답 시간이 60초를 초과하면 어떻게 되는가?
  → 해당 LLM은 타임아웃 처리하고 나머지 결과는 정상 표시
- 사용자가 빈 쿼리를 입력하면 어떻게 되는가?
  → 입력 검증 후 에러 메시지 표시
- 동일한 쿼리로 중복 분석 요청 시 어떻게 되는가?
  → 새로운 분석을 수행 (실시간 결과 제공 원칙)
- 인터넷 연결이 끊어진 상태에서 분석 요청 시?
  → 네트워크 에러 메시지 표시

## Requirements *(mandatory)*

### Functional Requirements

**쿼리 입력 및 분석**
- **FR-001**: 사용자는 검색 쿼리(필수), 타겟 도메인(선택), 브랜드명(선택)을 입력할 수 있어야 한다.
- **FR-002**: 분석 요청 시 4개 LLM(Perplexity, ChatGPT, Gemini, Claude)에 병렬로 요청을 전송해야 한다.
- **FR-003**: 개별 LLM 실패 시 나머지 LLM 결과는 정상적으로 반환되어야 한다 (부분 실패 허용).

**인용 데이터 추출**
- **FR-004**: 각 LLM 응답에서 인용된 소스(URL, 도메인, 제목)를 추출해야 한다.
- **FR-005**: 추출된 인용 데이터는 통합 스키마(UnifiedCitation)로 정규화되어야 한다.
- **FR-006**: Perplexity의 경우 발행일(publishedDate), 발췌문(snippet)을 추출해야 한다.
- **FR-007**: OpenAI의 경우 텍스트 위치(start_index, end_index)를 추출해야 한다.
- **FR-008**: Gemini의 경우 신뢰도 점수(confidenceScores)를 추출해야 한다.
- **FR-009**: Claude의 경우 웹 검색 결과에서 인용 정보를 추출해야 한다.

**결과 표시**
- **FR-010**: 각 LLM별로 별도의 결과 카드를 표시해야 한다.
- **FR-011**: 결과 카드에는 LLM 모델명, 응답 시간, 인용 개수, 답변 내용이 포함되어야 한다.
- **FR-012**: 타겟 도메인이 인용된 경우 시각적으로 강조 표시해야 한다.
- **FR-013**: 분석 요약(전체 인용률, 브랜드 멘션율, LLM별 비교)을 표시해야 한다.

**데이터 저장 및 이력**
- **FR-014**: 모든 분석 결과는 데이터베이스에 저장되어야 한다.
- **FR-015**: 분석 이력 페이지에서 과거 분석 목록을 조회할 수 있어야 한다.
- **FR-016**: 분석 상세 페이지에서 전체 결과를 확인할 수 있어야 한다.

**에러 처리**
- **FR-017**: LLM 응답 시간이 60초를 초과하면 타임아웃 처리해야 한다.
- **FR-018**: 에러 발생 시 사용자 친화적인 메시지를 표시해야 한다.
- **FR-019**: 에러 로그는 별도로 저장되어야 한다.

### Key Entities

- **Analysis (분석)**: 단일 쿼리에 대한 분석 세션. 쿼리 텍스트, 타겟 도메인, 브랜드명, 상태, 4개 LLM 결과, 요약 정보를 포함.
- **LLMResult (LLM 결과)**: 특정 LLM의 응답 결과. LLM 유형, 모델명, 응답 시간, 답변 내용, 성공/실패 여부, 에러 메시지를 포함.
- **UnifiedCitation (통합 인용)**: 정규화된 인용 정보. 소스 LLM, 순서, URL, 도메인, 제목, 발췌문, 발행일, 멘션 횟수, 신뢰도 점수, 텍스트 범위를 포함.
- **AnalysisSummary (분석 요약)**: 분석 결과 집계. 전체 인용률, 브랜드 멘션율, LLM별 통계를 포함.

### Assumptions

- 사용자 인증은 Phase 1 범위에 포함되지 않음 (Phase 3에서 구현)
- 프로젝트/경쟁사 관리 기능은 Phase 1 범위에 포함되지 않음 (Phase 2에서 구현)
- 분석 결과는 무기한 보존됨
- 동시 사용자 수는 초기에 100명 미만으로 예상

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 사용자는 쿼리 입력 후 120초 이내에 4개 LLM 분석 결과를 확인할 수 있다.
- **SC-002**: 개별 LLM 실패 시에도 나머지 LLM 결과는 정상적으로 표시된다.
- **SC-003**: 분석 결과 페이지 로딩 시간은 2초 이내이다.
- **SC-004**: 4개 LLM 모두에서 인용 데이터가 정확하게 추출된다 (수동 검증 시 95% 이상 정확도).
- **SC-005**: 분석 이력에서 과거 분석을 3번 이내 클릭으로 찾을 수 있다.
- **SC-006**: 사용자의 80%가 첫 사용 시 도움 없이 분석을 완료할 수 있다.
